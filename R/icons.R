fontAwesomeIcons <- list(
  solid = c(
    'address-book', 'address-card', 'adjust', 'align-center', 'align-justify',
    'align-left', 'align-right', 'ambulance',
    'american-sign-language-interpreting', 'anchor', 'angle-double-down',
    'angle-double-left', 'angle-double-right', 'angle-double-up', 'angle-down',
    'angle-left', 'angle-right', 'angle-up', 'archive', 'arrow-alt-circle-down',
    'arrow-alt-circle-left', 'arrow-alt-circle-right', 'arrow-alt-circle-up',
    'arrow-circle-down', 'arrow-circle-left', 'arrow-circle-right',
    'arrow-circle-up', 'arrow-down', 'arrow-left', 'arrow-right', 'arrow-up',
    'arrows-alt', 'arrows-alt-h', 'arrows-alt-v', 'assistive-listening-systems',
    'asterisk', 'at', 'audio-description', 'backward', 'balance-scale', 'ban',
    'barcode', 'bars', 'bath', 'battery-empty', 'battery-full', 'battery-half',
    'battery-quarter', 'battery-three-quarters', 'bed', 'beer', 'bell',
    'bell-slash', 'bicycle', 'binoculars', 'birthday-cake', 'blind', 'bold',
    'bolt', 'bomb', 'book', 'bookmark', 'braille', 'briefcase', 'bug',
    'building', 'bullhorn', 'bullseye', 'bus', 'calculator', 'calendar',
    'calendar-alt', 'calendar-check', 'calendar-minus', 'calendar-plus',
    'calendar-times', 'camera', 'camera-retro', 'car', 'caret-down',
    'caret-left', 'caret-right', 'caret-square-down',
    'caret-square-left', 'caret-square-right', 'caret-square-up', 'caret-up',
    'cart-arrow-down', 'cart-plus', 'certificate', 'chart-area', 'chart-bar',
    'chart-line', 'chart-pie', 'check', 'check-circle', 'check-square',
    'chevron-circle-down', 'chevron-circle-left', 'chevron-circle-right',
    'chevron-circle-up', 'chevron-down', 'chevron-left', 'chevron-right',
    'chevron-up', 'child', 'circle', 'circle-notch', 'clipboard', 'clock',
    'clone', 'closed-captioning', 'cloud', 'cloud-download-alt',
    'cloud-upload-alt', 'code', 'code-branch', 'coffee', 'cog', 'cogs',
    'columns', 'comment', 'comment-alt', 'comments', 'compass', 'compress',
    'copy', 'copyright', 'credit-card', 'crop', 'crosshairs', 'cube', 'cubes',
    'cut', 'database', 'deaf', 'desktop', 'dollar-sign', 'dot-circle',
    'download', 'edit', 'eject', 'ellipsis-h', 'ellipsis-v', 'envelope',
    'envelope-open', 'envelope-square', 'eraser', 'euro-sign',
    'exchange-alt', 'exclamation', 'exclamation-circle', 'exclamation-triangle',
    'expand', 'expand-arrows-alt', 'external-link-alt',
    'external-link-square-alt', 'eye', 'eye-dropper', 'eye-slash',
    'fast-backward', 'fast-forward', 'fax',
    'female', 'fighter-jet', 'file', 'file-alt', 'file-archive', 'file-audio',
    'file-code', 'file-excel', 'file-image', 'file-pdf', 'file-powerpoint',
    'file-video', 'file-word', 'film', 'filter', 'fire', 'fire-extinguisher',
    'flag', 'flag-checkered', 'flask', 'folder', 'folder-open', 'font',
    'forward', 'frown', 'futbol', 'gamepad', 'gavel', 'gem', 'genderless',
    'gift', 'glass-martini', 'globe', 'graduation-cap', 'h-square',
    'hand-lizard', 'hand-paper', 'hand-peace', 'hand-point-down',
    'hand-point-left', 'hand-point-right', 'hand-point-up', 'hand-pointer',
    'hand-rock', 'hand-scissors', 'hand-spock', 'handshake', 'hashtag', 'hdd',
    'heading', 'headphones', 'heart', 'heartbeat', 'history', 'home',
    'hospital', 'hourglass', 'hourglass-end', 'hourglass-half',
    'hourglass-start', 'i-cursor', 'id-badge', 'id-card', 'image', 'images',
    'inbox', 'indent', 'industry', 'info', 'info-circle', 'italic', 'key',
    'keyboard', 'language', 'laptop', 'leaf', 'lemon', 'level-down-alt',
    'level-up-alt', 'life-ring', 'lightbulb', 'link', 'lira-sign', 'list',
    'list-alt', 'list-ol', 'list-ul', 'location-arrow', 'lock', 'lock-open',
    'long-arrow-alt-down', 'long-arrow-alt-left', 'long-arrow-alt-right',
    'long-arrow-alt-up', 'low-vision', 'magic', 'magnet', 'male', 'map',
    'map-marker', 'map-marker-alt', 'map-pin', 'map-signs', 'mars',
    'mars-double', 'mars-stroke', 'mars-stroke-h', 'mars-stroke-v',
    'medkit', 'meh', 'mercury', 'microchip', 'microphone', 'microphone-slash',
    'minus', 'minus-circle', 'minus-square', 'mobile', 'mobile-alt',
    'money-bill-alt', 'moon', 'motorcycle', 'mouse-pointer', 'music', 'neuter',
    'newspaper', 'object-group', 'object-ungroup', 'outdent', 'paint-brush',
    'paper-plane', 'paperclip', 'paragraph', 'paste', 'pause', 'pause-circle',
    'paw', 'pen-square', 'pencil-alt', 'percent', 'phone', 'phone-square',
    'phone-volume', 'plane', 'play', 'play-circle', 'plug', 'plus',
    'plus-circle', 'plus-square', 'podcast', 'pound-sign', 'power-off',
    'print', 'puzzle-piece', 'qrcode', 'question', 'question-circle',
    'quote-left', 'quote-right', 'random', 'recycle', 'redo', 'redo-alt',
    'registered', 'reply', 'reply-all', 'retweet', 'road', 'rocket', 'rss',
    'rss-square', 'ruble-sign', 'rupee-sign', 'save', 'search', 'search-minus',
    'search-plus', 'server', 'share', 'share-alt', 'share-alt-square',
    'share-square', 'shekel-sign', 'shield-alt', 'ship', 'shopping-bag',
    'shopping-basket', 'shopping-cart', 'shower', 'sign-in-alt',
    'sign-language', 'sign-out-alt', 'signal', 'sitemap', 'sliders-h', 'smile',
    'snowflake', 'sort', 'sort-alpha-down', 'sort-alpha-up',
    'sort-amount-down', 'sort-amount-up', 'sort-down', 'sort-numeric-down',
    'sort-numeric-up', 'sort-up', 'space-shuttle', 'spinner', 'square', 'star',
    'star-half', 'step-backward', 'step-forward', 'stethoscope', 'sticky-note',
    'stop', 'stop-circle', 'street-view', 'strikethrough', 'subscript',
    'subway', 'suitcase', 'sun', 'superscript', 'sync', 'sync-alt', 'table',
    'tablet', 'tablet-alt', 'tachometer-alt', 'tag', 'tags', 'tasks', 'taxi',
    'terminal', 'text-height', 'text-width', 'th', 'th-large', 'th-list',
    'thermometer-empty', 'thermometer-full', 'thermometer-half',
    'thermometer-quarter', 'thermometer-three-quarters', 'thumbs-down',
    'thumbs-up', 'thumbtack', 'ticket-alt', 'times', 'times-circle', 'tint',
    'toggle-off', 'toggle-on', 'trademark', 'train', 'transgender',
    'transgender-alt', 'trash', 'trash-alt', 'tree', 'trophy', 'truck', 'tty',
    'tv', 'umbrella', 'underline', 'undo', 'undo-alt', 'universal-access',
    'university', 'unlink', 'unlock', 'unlock-alt', 'upload', 'user',
    'user-circle', 'user-md', 'user-plus', 'user-secret', 'user-times', 'users',
    'utensil-spoon', 'utensils', 'venus', 'venus-double', 'venus-mars', 'video',
    'volume-down', 'volume-off', 'volume-up', 'wheelchair', 'wifi',
    'window-close', 'window-maximize', 'window-minimize', 'window-restore',
    'won-sign', 'wrench', 'yen-sign'
  ),
  regular = c(
    'address-book', 'address-card', 'arrow-alt-circle-down',
    'arrow-alt-circle-left', 'arrow-alt-circle-right', 'arrow-alt-circle-up',
    'bell', 'bell-slash', 'bookmark', 'building', 'calendar', 'calendar-alt',
    'calendar-check', 'calendar-minus', 'calendar-plus', 'calendar-times',
    'caret-square-down', 'caret-square-left', 'caret-square-right',
    'caret-square-up', 'chart-bar', 'check-circle', 'check-square',
    'circle', 'clipboard', 'clock', 'clone', 'closed-captioning',
    'comment', 'comment-alt', 'comments', 'compass', 'copy', 'copyright',
    'credit-card', 'dot-circle', 'edit', 'envelope', 'envelope-open',
    'eye-slash', 'file', 'file-alt', 'file-archive', 'file-audio', 'file-code',
    'file-excel', 'file-image', 'file-pdf', 'file-powerpoint', 'file-video',
    'file-word', 'flag', 'folder', 'folder-open', 'frown', 'futbol', 'gem',
    'hand-lizard', 'hand-paper', 'hand-peace', 'hand-point-down',
    'hand-point-left', 'hand-point-right', 'hand-point-up', 'hand-pointer',
    'hand-rock', 'hand-scissors', 'hand-spock', 'handshake', 'hdd', 'heart',
    'hospital', 'hourglass', 'id-badge', 'id-card', 'image', 'images',
    'keyboard', 'lemon', 'life-ring', 'lightbulb', 'list-alt', 'map',
    'meh', 'minus-square', 'money-bill-alt', 'moon', 'newspaper',
    'object-group', 'object-ungroup', 'paper-plane', 'pause-circle',
    'play-circle', 'plus-square', 'question-circle', 'registered', 'save',
    'share-square', 'smile', 'snowflake', 'square', 'star', 'star-half',
    'sticky-note', 'stop-circle', 'sun', 'thumbs-down', 'thumbs-up',
    'times-circle', 'trash-alt', 'user', 'user-circle', 'window-close',
    'window-maximize', 'window-restore'
  ),
  brands = c(
    '500px', 'accessible-icon', 'accusoft', 'adn', 'adversal', 'affiliatetheme',
    'algolia', 'amazon', 'amilia', 'android', 'angellist', 'angrycreative',
    'angular', 'app-store', 'app-store-ios', 'apper', 'apple', 'apple-pay',
    'asymmetrik', 'audible', 'autoprefixer', 'avianex', 'aviato', 'aws',
    'bandcamp', 'behance', 'behance-square', 'bimobject', 'bitbucket',
    'bitcoin', 'bity', 'black-tie', 'blackberry', 'blogger', 'blogger-b',
    'bluetooth', 'bluetooth-b', 'btc', 'buromobelexperte', 'buysellads',
    'cc-amex', 'cc-apple-pay', 'cc-diners-club', 'cc-discover', 'cc-jcb',
    'cc-mastercard', 'cc-paypal', 'cc-stripe', 'cc-visa', 'centercode',
    'chrome', 'cloudscale', 'cloudsmith', 'cloudversify', 'codepen', 'codiepie',
    'connectdevelop', 'contao', 'cpanel', 'creative-commons', 'css3', 'css3-alt',
    'cuttlefish', 'd-and-d', 'dashcube', 'delicious', 'deploydog', 'deskpro',
    'deviantart', 'digg', 'digital-ocean', 'discord', 'discourse', 'dochub',
    'docker', 'draft2digital', 'dribbble', 'dribbble-square', 'dropbox',
    'drupal', 'dyalog', 'earlybirds', 'edge', 'ember', 'empire', 'envira',
    'erlang', 'etsy', 'expeditedssl', 'facebook', 'facebook-f',
    'facebook-messenger', 'facebook-square', 'firefox', 'first-order',
    'firstdraft', 'flickr', 'fly', 'font-awesome', 'font-awesome-alt',
    'font-awesome-flag', 'fonticons', 'fonticons-fi', 'fort-awesome',
    'fort-awesome-alt', 'forumbee', 'foursquare', 'free-code-camp',
    'freebsd', 'get-pocket', 'gg', 'gg-circle', 'git', 'git-square',
    'github', 'github-alt', 'github-square', 'gitkraken', 'gitlab', 'gitter',
    'glide', 'glide-g', 'gofore', 'goodreads', 'goodreads-g', 'google',
    'google-drive', 'google-play', 'google-plus', 'google-plus-g',
    'google-plus-square', 'google-wallet', 'gratipay', 'grav', 'gripfire',
    'grunt', 'gulp', 'hacker-news', 'hacker-news-square', 'hire-a-helper',
    'hooli', 'hotjar', 'houzz', 'html5', 'hubspot', 'imdb', 'instagram',
    'internet-explorer', 'ioxhost', 'itunes', 'itunes-note', 'jenkins', 'joget',
    'joomla', 'js', 'js-square', 'jsfiddle', 'keycdn', 'kickstarter',
    'kickstarter-k', 'laravel', 'lastfm', 'lastfm-square', 'leanpub', 'less',
    'line', 'linkedin', 'linkedin-in', 'linode', 'linux', 'lyft', 'magento',
    'maxcdn', 'medapps', 'medium', 'medium-m', 'medrt', 'meetup', 'microsoft',
    'mix', 'mixcloud', 'mizuni', 'modx', 'monero', 'napster', 'nintendo-switch',
    'node', 'node-js', 'npm', 'ns8', 'nutritionix', 'odnoklassniki',
    'odnoklassniki-square', 'opencart', 'openid', 'opera', 'optin-monster',
    'osi', 'page4', 'pagelines', 'palfed', 'patreon', 'paypal', 'periscope',
    'phabricator', 'phoenix-framework', 'pied-piper', 'pied-piper-alt',
    'pied-piper-pp', 'pinterest', 'pinterest-p', 'pinterest-square',
    'playstation', 'product-hunt', 'pushed', 'python', 'qq', 'quora',
    'ravelry', 'react', 'rebel', 'red-river', 'reddit', 'reddit-alien',
    'reddit-square', 'rendact', 'renren', 'replyd', 'resolving', 'rocketchat',
    'rockrms', 'safari', 'sass', 'schlix', 'scribd', 'searchengin', 'sellcast',
    'sellsy', 'servicestack', 'shirtsinbulk', 'simplybuilt', 'sistrix',
    'skyatlas', 'skype', 'slack', 'slack-hash', 'slideshare', 'snapchat',
    'snapchat-ghost', 'snapchat-square', 'soundcloud', 'speakap', 'spotify',
    'stack-exchange', 'stack-overflow', 'staylinked', 'steam', 'steam-square',
    'steam-symbol', 'sticker-mule', 'strava', 'stripe', 'stripe-s',
    'studiovinari', 'stumbleupon', 'stumbleupon-circle', 'superpowers',
    'supple', 'telegram', 'telegram-plane', 'tencent-weibo', 'themeisle',
    'trello', 'tripadvisor', 'tumblr', 'tumblr-square', 'twitch', 'twitter',
    'twitter-square', 'typo3', 'uber', 'uikit', 'uniregistry', 'untappd', 'usb',
    'ussunnah', 'vaadin', 'viacoin', 'viadeo', 'viadeo-square', 'viber', 'vimeo',
    'vimeo-square', 'vimeo-v', 'vine', 'vk', 'vnv', 'vuejs', 'weibo', 'weixin',
    'whatsapp', 'whatsapp-square', 'whmcs', 'wikipedia-w', 'windows',
    'wordpress', 'wordpress-simple', 'wpbeginner', 'wpexplorer', 'wpforms',
    'xbox', 'xing', 'xing-square', 'y-combinator', 'yahoo', 'yandex',
    'yandex-international', 'yelp', 'yoast', 'youtube'
  )
)

#' Font Awesome icons
#'
#' A set of icons developed by Fort Awesome. Icons have regular and solid
#' variants. The regular variant of an icon is often the inverse or outline
#' of the solid variant.
#'
#' @param name A character string specifying the icon name, the `fa-` prefix
#'   is not necessary.
#'
#' @param solid One of `TRUE` or `FALSE` specifying if the icon's solid variant
#'   is used, defaults to `TRUE`. If the icon does not have a solid variant a
#'   warning is raised.
#'
#' @param border One of `TRUE` or `FALSE` specifying if a border is added to the
#'   icon, defaults to `FALSE`.
#'
#' @param size One of `"xs"`, `"sm"`, `"md"`, `"lg"`, or `"1x"` through `"10x"`
#'   specifying the size of the icon, defaults to `"md"`.
#'
#' @param float One of `"left"` or `"right"` specifying a direction in which to
#'   float the element. This is particularly useful when wrapping text around an
#'   icon. Defaults to `NULL` in which case a float is not applied.
#'
#' @param fixed One of `TRUE` or `FALSE`, if `TRUE` the icon has a fixed width,
#'   defaults to `FALSE`. This feature is particularly useful or necessary when
#'   vertically aligning icons.
#'
#' @param spin One of `TRUE` or `FALSE`, if `TRUE` the icon is animated and
#'   spins, defaults to `FALSE`. This functionality works best with circular
#'   icons like `"spinner"`, `"circle-notch"`, `"sync"`, or `"cog"`.
#'
#' @param ... Additional named arguments passed as HTML attributes to the parent
#'   element.
#'
#' @seealso
#'
#' For a complete list of possible icons please refer to the Font Awesome
#' website, \url{https://fontawesome.com/icons?d=listing&m=free}.
#'
#' @export
#' @examples
#' if (interactive()) {
#'   shinyApp(
#'     ui = container(
#'       fluid = FALSE,
#'       blockquote(
#'         fontAwesome("quote-left", size = "2x", border = TRUE, pull = "left"),
#'         "It's the questions we can't answer that teach us the most. They teach
#'         us how to think. If you give a man an answer, all he gains is a little
#'         fact. But give him a question and he'll look for his own answers.",
#'         source = "Patrick Rothfuss"
#'       )
#'     ),
#'     server = function(input, output) {
#'
#'     }
#'   )
#' }
#'
fontAwesome <- function(name, solid = TRUE, size = "md", border = FALSE,
                        float = NULL, fixed = FALSE, spin = FALSE, ...) {
  if (!is.character(name)) {
    stop(
      "invalid `fontAwesome` argument, `name` must be a character string",
      call. = FALSE
    )
  }

  if (!grepl("^[a-z]", name) || grepl("fa-", name)) {
    stop(
      'invalid `fontAwesome` argument, `name` should not include a leading ',
      '"fa-" or "-"',
      call. = FALSE
    )
  }

  if (name %in% fontAwesomeIcons$brands) {
    iconSet <- "fab"
  } else if (name %in% fontAwesomeIcons$regular) {
    iconSet <- "far"
  } else {
    iconSet <- "fas"
  }

  if (solid) {
    if (!(name %in% fontAwesomeIcons$solid)) {
      warning(
        'incorrect `fontAwesome` argument, "', name, '" icon does not have ',
        "a solid variant",
        call. = FALSE
      )
    } else {
      iconSet <- "fas"
    }
  }

  if (!re(float, "left|right")) {
    stop(
      "invalid `fontAwesome` argument, `float` must be one of ",
      '"left" or "right"',
      call. = FALSE
    )
  }

  tags$i(
    class = collate(
      iconSet,
      paste0("fa-", name),
      if (size != "md") paste0("fa-", size),
      if (border) "fa-border",
      if (fixed) "fa-fw",
      if (!is.null(float)) paste0("fa-pull-", float),
      if (spin) "fa-spin"
    ),
    `aria-hidden` = "true",
    ...,
    `font-awesome`()
  )
}

#' A spinner
#'
#' Start or stop a spinner based on process progress.
#'
#' @param id A character specifying the id of the spinner output.
#'
#' @param type One of `"circle"`, `"cog"`, `"dots"`, or `"sync"` specifying the
#'   type of spinner, defaults to `"circle"`.
#'
#' @param pulse One of `TRUE` or `FALSE`, if `TRUE` the spinner rotates in 8
#'   discrete steps, defaults to `FALSE`.
#'
#' @export
#' @examples
#' if (interactive()) {
#'   shinyApp(
#'     ui = container(
#'       col(
#'         spinnerOutput("spin", pulse = TRUE),
#'         buttonInput("trigger", "Start/stop")
#'       ) %>%
#'         display("flex") %>%
#'         content("around")
#'     ),
#'     server = function(input, output) {
#'       observeEvent(input$trigger, {
#'         if (input$trigger %% 2 == 1) {
#'           startSpinner("spin")
#'         } else {
#'           stopSpinner("spin")
#'         }
#'       })
#'     }
#'   )
#' }
#'
spinnerOutput <- function(id, type = "circle", pulse = FALSE, ...) {
  tags$i(
    class = collate(
      "dull-spinner-output",
      "fas",
      switch(
        type,
        circle = "fa-circle-notch",
        cog = "fa-cog",
        dots = "fa-spinner",
        sync = "fa-sync"
      ),
      if (pulse) "fa-pulse" else "fa-spin",
      "pause"
    ),
    id = id,
    ...,
    `font-awesome`()
  )
}

#' @rdname spinnerOutput
#' @export
startSpinner <- function(id, session = getDefaultReactiveDomain()) {
  session$sendProgress("dull-spinner", list(
    id = id,
    action = "start"
  ))
}

#' @rdname spinnerOutput
#' @export
stopSpinner <- function(id, session = getDefaultReactiveDomain()) {
  session$sendProgress("dull-spinner", list(
    id = id,
    action = "stop"
  ))
}
