!function(){"use strict";const e=new Shiny.InputBinding;$.extend(e,{find:function(e){return $(e).find(".yonder-address[id]")},getValue:function(e){var t=$(e).find("input"),n=["line1","line2","city","state","zip"],i=t.map((e,t)=>$(t).val()).get().reduce(function(e,t,i){return e[n[i]]=t,e},{});return Object.values(i).reduce((e,t)=>e||t)?i:null},getState:function(e,t){return{value:this.getValue(e)}},subscribe:function(e,t){$(e).on("change.addressInputBinding",function(e){t()})},unsubscribe:function(e){$(e).off(".addressInputBinding")}});let t=new Shiny.InputBinding;$.extend(t,{Selector:{SELF:".yonder-alert-container"},Alerts:[],getValue:function(e){return null},receiveMessage:function(e,t){if(void 0!==t.type){if("show"===t.type){let e=t.data,n=$(e.content);return e.action&&(n.append($(`<button class="btn btn-link alert-link alert-action">${e.action}</button>`)),n.on("click",".alert-action",t=>{Shiny.onInputChange(e.action,!0)})),this.Alerts.push({el:n,action:e.action}),n.appendTo($(this.Selector.SELF)).velocity({top:0,opacity:1},{duration:300,easing:"easeOutCubic",queue:!1}),void(null!==e.duration&&setTimeout(()=>{if(0===this.Alerts.length)return;let e=this.Alerts.shift();e.action&&Shiny.onInputChange(e.action,null),e.el.remove()},e.duration))}if("close"===t.type){if(0===this.Alerts.length)return;let e=t.data,n="number"==typeof e.index?[e.index]:e.index,i="string"==typeof e.text?[e.text]:e.text,a=Object.entries(e.attrs).map(e=>`[${e[0]}${e[1]?("class"===e[0]?"*=":"=")+e[1]:""}]`).join("");this.Alerts=this.Alerts.filter((e,t)=>{let o=$(e.el);return!(n.includes(t)||i.includes(o.text())||o.is(a))||(e.action&&Shiny.onInputChange(e.action,null),o.remove(),!1)})}}}});let n=new Shiny.InputBinding;$.extend(n,{Selector:{SELF:".yonder-button-group[id]",VALUE:".btn",LABEL:".btn"},_value:null,getValue:function(e){return this._value},subscribe:function(e,t){var n=this;$(e).on("click.buttonGroupInputBinding","button",function(e){n._value=$(this).data("value"),t()})},unsubscribe:function(e){$(e).off(".buttonGroupInputBinding","button")}});let i=new Shiny.InputBinding;$.extend(i,{Selector:{SELF:".yonder-button[id]",VALUE:".yonder-button",LABEL:".yonder-button"},Events:[{type:"click",callback:e=>e.setAttribute("data-value",+e.getAttribute("data-value")+1)}],initialize:function(e){e.setAttribute("data-value",0)},getType:function(e){return"yonder.button"},getValue:function(e){return e.getAttribute("data-value")}});let a=new Shiny.InputBinding;$.extend(a,{Selector:{SELF:".yonder-checkbar[id]",VALUE:".btn input",LABEL:".btn > span",SELECTED:".btn.active input"},Events:[{type:"change"},{type:"click"}],getState:function(e,t){return{value:this.getValue(e)}}});let o=new Shiny.InputBinding;$.extend(o,{Selector:{SELF:".yonder-checkbox[id]",VALUE:".custom-control-input",LABEL:".custom-control-label",SELECTED:".custom-control-input:checked:not(:disabled)",VALIDATE:".custom-control-input"},Events:[{type:"change"}],getValue:function(e){var t=$(e).find(`${this.Selector.SELECTED}`).data("value");return void 0===t?null:t},_getLabel:function(e){return $(e).find(`${this.Selector.LABEL}`).text()},getState:function(e,t){return{label:this._getLabel(e),value:this.getValue(e)}}});let r=new Shiny.InputBinding;$.extend(r,{Selector:{SELF:".yonder-date[id]"},Events:[{type:"dateinput:close"}],initialize:function(e){let t=$(e).data(),n={onClose:(t,n,i)=>$(e).trigger("dateinput:close")};"multiple"===t.mode&&"alt-format"===t.altFormat&&(n.altFormat="M j, Y",n.conjunction="; "),!t.defaultDate||"range"!==t.mode&&"multiple"!==t.mode||(n.defaultDate=t.defaultDate.split("\\,"),e.removeAttribute("data-default-date")),t.enable&&(n.enable=t.enable.split("\\,"),e.removeAttribute("data-enable")),flatpickr(e,n)},getType:()=>"yonder.date",getValue:e=>e._flatpickr.selectedDates,receiveMessage:function(e,t){if(null!==t.type)throw"receiveMessage not implemented for date inputs"}});let l=new Shiny.InputBinding;$.extend(l,{Selector:{SELF:".yonder-file[id]"},getValue:function(e){return null},sendFile:function(e,t,n,i,a){let o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-Type","application/octet-stream"),o.onreadystatechange=function(){o.readyState==XMLHttpRequest.DONE&&200==o.status&&i&&Shiny.shinyapp.makeRequest("uploadEnd",[t,a.id],e=>{let t=$(a).find("input[type='file']");t.val(""),t.text("Choose file")},e=>{console.error(`uploadEnd request failed for ${a.id}: ${e}`)})},o.send(n)},doUpload:function(e,t){if(!t)return;let n=$.map(t,e=>({name:e.name,size:e.size,type:e.type}));Shiny.shinyapp.makeRequest("uploadInit",[n],n=>{let i=n.jobId,a=n.uploadUrl;for(var o=0;o<t.length;o++)this.sendFile(a,i,t[o],o===t.length-1,e)},t=>{console.error(`uploadInit request failed for ${e.id}: ${t}`)})},subscribe:function(e,t){let n=$(e).find("input[type='file']");if(!n.length)return;let i=n.get(0);$(e).find(".btn").length?$(e).on("click.fileInputBinding",".btn",t=>{this.doUpload(e,i.files)}):$(e).on("change.fileInputBinding",t=>{this.doUpload(e,i.files)}),$(e).on("dragover.fileInputBinding",e=>{e.stopPropagation(),e.preventDefault()}),$(e).on("dragenter.fileInputBinding",e=>{e.stopPropagation(),e.preventDefault()}),$(e).on("drop.fileInputBinding",t=>{t.stopPropagation(),t.preventDefault(),i.hasAttribute("multiple")?this.doUpload(e,t.originalEvent.dataTransfer.files):this.doUpload(e,t.originalEvent.dataTransfer.files[0])})},unsubscribe:function(e){$(e).off(".fileInputBinding")}});let u=new Shiny.InputBinding;$.extend(u,{Events:[{type:"submit",callback:e=>{let t=e.querySelector("button[data-type='submit']");null!==t&&t.setAttribute("data-value",+t.getAttribute("data-value")+1)}}],initialize:function(e){let t=e.querySelector("button[data-type='submit']");null!==t&&t.setAttribute("data-value",0)},find:function(e){let t=$(e).find(".yonder-form[id]");return t.children("button[data-type='submit']").length?t:null},getValue:function(e){let t=e.querySelector("button[data-type='submit']");if(null!==t)return+t.getAttribute("data-value")}});let d=new Shiny.InputBinding;$.extend(d,{Selector:{SELF:".yonder-group[id]",VALUE:"input",SELECTED:".input-group-prepend .input-group-text, input, .input-group-append .input-group-text"},Events:[{type:"input",debounce:!0},{type:"change",debounce:!0}],getType:function(e){return"yonder.group"},getState:function(e){return{value:this.getValue(e)}}});let s=new Shiny.InputBinding;$.extend(s,{Selector:{SELF:".yonder-link[id]"},Events:[{type:"click",callback:e=>e.setAttribute("data-value",+e.getAttribute("data-value")+1)}],initialize:function(e){e.setAttribute("data-value",0)},getType:function(e){return"yonder.link"},getValue:function(e){return{value:e.getAttribute("data-value"),id:e.id}}});let c=new Shiny.InputBinding;$.extend(c,{find:function(e){return $(e).find(".yonder-login[id]")},getValue:function(e){var t=$(e).find(".form-control").map((e,t)=>$(t).val()).get();return t[0]||t[1]?{username:t[0],password:t[1]}:null},getState:function(e,t){return{value:this.getValue(e)}},subscribe:function(e,t){$(e).on("click.loginInputBinding",".btn",function(e){t()})},unsubscribe:function(e){$(e).off(".loginInputBinding")}});let p=new Shiny.InputBinding;$.extend(p,{find:function(e){return $(e).find(".yonder-nav[id]")},getValue:function(e){return $(".nav",e).find(".active").data("value")},getState:function(e,t){return{value:this.getValue(e)}},subscribe:function(e,t){$(e).on("shown.bs.tab.navInputBinding",function(e){t()})},unsubscribe:function(e){$(e).off(".navInputBinding")}});let f=new Shiny.InputBinding;$.extend(f,{Selector:{SELF:".yonder-radio[id]",VALUE:".custom-control-input",LABEL:".custom-control-label",SELECTED:".custom-control-input:checked:not(:disabled)",VALIDATE:".custom-control-input"},Events:[{type:"change"}],getState:function(e,t){return{value:this.getValue(e)}}});let g=new Shiny.InputBinding;$.extend(g,{Selector:{SELF:".yonder-radiobar[id]",VALUE:".btn input",LABEL:".btn > span",SELECTED:".btn input:checked"},Events:[{type:"click"},{type:"change"}],getState:function(e,t){return{value:this.getValue(e)}}});let h=new Shiny.InputBinding;$.extend(h,{Selector:{SELF:".yonder-range[id]"},Events:[{type:"change"}],initialize:e=>{let t=$(e),n=t.find("input[type='text']");n.ionRangeSlider();let i=t.attr("class").split(/\s+/).filter(e=>/^bg-[a-z-]+$/.test(e)).join(" ");i&&(t.find(".irs-slider,.irs-bar,.irs-bar-edge,.irs-to,.irs-from,.irs-single,.irs-slider").addClass(i),t.removeClass(i)),n.data("no-fill")&&t.find(".irs-bar,.irs-bar-edge").addClass("no-fill")},getId:function(e){return e.id},getValue:function(e){var t=$("input[type='text']",e),n=t.data("ionRangeSlider");return"double"==t.data("type")?[n.result.from,n.result.to]:"single"==t.data("type")?null!==n.result.from_value?n.result.from_value.replace("&#44;",","):n.result.from:void 0},getState:function(e,t){return{value:this.getValue(e)}},receiveMessage:function(e,t){console.error("receiveMessage: not implemented for range input")},dispose:function(e){$("input[type='text']",e).data("ionRangeSlider").destroy()}});let y=new Shiny.InputBinding;$.extend(y,{Selector:{SELF:".yonder-select[id]",VALUE:"option",LABEL:"option",SELECTED:"option:checked",VALIDATE:"select"},Events:[{type:"change"}],getState:function(e,t){return{value:this.getValue(e)}}});let b=new Shiny.InputBinding;$.extend(b,{Selector:{SELF:".yonder-tabs[id]",SELECTED:".nav-item > .active:not(.disabled)"},Events:[{type:"shown.bs.tab"}],initialize:function(e){let t=e.id,n=$(e).find(".nav-link"),i=$(`.tab-content[data-tabs="${t}"] > .tab-pane`),a=n.map((e,t)=>t.classList.contains("active")).get().indexOf(!0);if(0===n.length||0===i.length)throw"tabs input: missing tabs or panes";if(n.length!=i.length)throw"tabs input: incorrect number of tabs for panes";i.each((e,n)=>{let i=$(n);i.attr({id:`${t}-pane-${e}`,"aria-labelledby":`${t}-tab-${e}`}),i.removeAttr("data-tabs"),e===a&&i.addClass("show active")}),n.each((e,n)=>{$(n).attr({id:`${t}-tab-${e}`,"data-toggle":"tab",href:`#${t}-pane-${e}`,"aria-controls":`${t}-pane-${e}`})})}});let v=new Shiny.InputBinding;$.extend(v,{Selector:{SELF:".yonder-textual[id]",VALIDATE:"input"},Events:[{type:"change",debounce:!0},{type:"input",debounce:!0}],getValue:function(e){var t=$(e).find("input"),n=void 0===t.val()?null:t.val();return null===n?null:"number"===t.attr("type")?parseInt(n,10):n},getType:function(e){var t=$("input",e).attr("type");return"date"===t?"yonder.date":"time"===t&&"yonder.time"},getState:function(e,t){return{value:this.getValue(e)}},getRatePolicy:function(){return{policy:"debounce",delay:250}}});let S=new Shiny.OutputBinding;$.extend(S,{find:function(e){return $(e).find(".yonder-badge[id]")},getId:function(e){return e.id},renderValue:function(e,t){void 0!==t.data&&(e.innerHTML=t.data)},renderError:function(e,t){},clearError:function(e){}});let m=new Shiny.OutputBinding;$.extend(m,{find:function(e){return $(e).find(".yonder-sparkline[id]")},getId:function(e){return e.id},renderValue:function(e,t){if(void 0!==t.data){let n=e.getAttribute("data-labels");e.innerHTML=n?`${t.from}{${t.data.join(",")}}${t.to}`:`{${t.data.join(",")}}`}},renderError:function(e,t){},clearError:function(e){}});let E=new Shiny.InputBinding;$.extend(E,{Selector:{SELF:".yonder-table[id]"},Type:"yonder.table",Events:[{type:"chabudai:select"},{type:"chabudai:edited"}],getValue:function(e){return JSON.stringify($(e).table("selected"))},receiveMessage:function(e,t){}});let I=new Shiny.OutputBinding;$.extend(I,{find:function(e){return $(e).find(".yonder-table[id]")},renderValue:function(e,t){t.data&&$(e).table({data:t.data})}});let L=new Shiny.InputBinding;$.extend(L,{find:e=>$(e).find(".yonder-list-groupl[id]"),getId:e=>e.id,getValue:e=>$(e).children(".list-group-item.active:not(.disabled)").map((e,t)=>$(t).data("value")).get(),getState:function(e,t){return{value:this.getValue(e)}},subscribe:(e,t)=>{$(e).on("change.listGroupInputBinding",e=>t())},unsubscribe:e=>$(e).off(".listGroupInputBinding")});let A=new Shiny.OutputBinding;$.extend(A,{find:e=>$(e).find(".yonder-list-group[id]"),getId:e=>e.id,renderValue:(e,t)=>{if(!t.items)return;let n=t.items.join("\n");Shiny.renderContent(e,n)}});const V={"yonder.addressInput":e,"yonder.alertInput":t,"yonder.buttonGroupInput":n,"yonder.buttonInput":i,"yonder.checkbarInput":a,"yonder.checkboxInput":o,"yonder.dateInput":r,"yonder.fileInput":l,"yonder.formInput":u,"yonder.groupInput":d,"yonder.linkInput":s,"yonder.loginInput":c,"yonder.navInput":p,"yonder.radioInput":f,"yonder.radiobarInput":g,"yonder.rangeInput":h,"yonder.selectInput":y,"yonder.tableInput":E,"yonder.tabsInput":b,"yonder.textualInput":v,"yonder.listGroupInputBinding":L},B={"yonder.badgeOutput":S,"yonder.sparklineOutput":m,"yonder.tableOutput":I,"yonder.listGroupOutput":A};(function(){this.find=function(e){return e.querySelectorAll(`${this.Selector.SELF}[id]`)},this.getId=function(e){return e.id},this.getType=function(e){return!!this.Type&&this.Type},this.getValue=function(e){if(!this.hasSelector("SELECTED"))return null;let t=$(e).find(`${this.Selector.SELECTED}`).map((e,t)=>{let n=$(t);return n.is("[data-value]")?n.data("value"):n.is("input")?n.val():n.text()}).get();return void 0===t?null:t},this.subscribe=function(e,t){if(this.isFormElement(e))$(e).closest(".yonder-form[id]").on("submit",e=>t());else if(void 0!==this.Events&&this.Events.length)for(const n of this.Events||[])$(e).on(`${n.type}.yonder`,i=>{n.callback&&n.callback(e),t(n.debounce||!1)})},this.unsubscribe=function(e){$(e).off("yonder")},this.updateChoices=function(e,t){if(!this.hasSelector("VALUE")||!this.hasSelector("LABEL"))return;if(this.Selector.VALUE===this.Selector.SELF){let n=t[$(e).data("value")];return void(void 0!==n&&$(e).html(n))}let n=$(e).find(`${this.Selector.VALUE}`),i=$(e).find(`${this.Selector.LABEL}`);n.length==i.length?n.each((e,n)=>{let a=$(n),o=$(i.get(e)),r=t[a.data("value")];void 0!==r&&o.html(r)}):console.error("updateChoices: mismatched number of inputs and labels")},this.updateValues=function(e,t){if(this.hasSelector("VALUE")){if("string"==typeof t||Array.isArray(t)){let n=$(e).find(`${this.Selector.VALUE}`),i="string"==typeof t?[t]:t;return n.has(":not(input[type='text'])").length?void console.error("updateValues: expecting all inputs to be text if new values are unnamed"):n.length!=i.length?void console.error("updateValues: mismatched number of inputs and values"):void n.each((e,t)=>{let n=$(t);n.val(i[e]),n.trigger("change")})}if(this.Selector.VALUE!==this.Selector.SELF)$(e).find(`${this.Selector.VALUE}`).each((e,n)=>{let i=$(n),a=t[i.data("value")];void 0!==a&&i.data("value",a)});else{let e=t[$input.data("value")];void 0!==e&&$input.data("value",e)}}},this.markValid=function(e,t){if(!this.hasSelector("VALIDATE"))return;$(e).find(this.Selector.VALIDATE).removeClass("is-invalid").addClass("is-valid");let n=$(e).find(".valid-feedback");n.length&&n.text(t.msg)},this.markInvalid=function(e,t){if(!this.hasSelector("VALIDATE"))return;$(e).find(this.Selector.VALIDATE).removeClass("is-valid").addClass("is-invalid");let n=$(e).find(".invalid-feedback");n.length&&n.text(t.msg)},this.receiveMessage=function(e,t){if(!t.type)return;let[n,i=null]=t.type.split(":");if("update"===n){if(!i||void 0===t.data)return;return"choices"===i&&this.updateChoices(e,t.data),void("values"===i&&this.updateValues(e,t.data))}if("mark"===n){if(!i)return;return"valid"===i&&this.markValid(e,t.data),void("invalid"===i&&this.markInvalid(e,t.data))}},this.hasSelector=function(e){return void 0!==this.Selector&&void 0!==this.Selector[e]},this.isFormElement=function(e){return $(e).parents(".yonder-form[id]").length>0}}).call(Shiny.InputBinding.prototype),Object.keys(V).forEach(e=>{Shiny.inputBindings.register(V[e],e)}),Object.keys(B).forEach(e=>{Shiny.outputBindings.register(B[e],e)}),$(()=>{$('[data-toggle="tooltip"]').tooltip()}),$(()=>{$('[data-toggle="popover"]').popover()}),$(()=>{$(".yonder-file").on("click",".input-group-append",function(e){$(e.delegateTarget).find("input[type='file']").trigger("click")})}),$(()=>{$("body").append($("<div class='yonder-alert-container' id='alert-container'></div>"))}),$(()=>{$(".nav:not([role='tablist']) li").on("click",function(e){var t=$(this);$(".nav-link",t.parent(".nav")).removeClass("active"),$(".nav-link",t).addClass("active")})}),$(document).on("shiny:connected",function(){$('.yonder-submit[data-type="submit"]').attr("type","submit")}),$(()=>{$(document).on("shown.bs.modal",".modal",function(e){$(".modal").find(".shiny-bound-output, .shiny-bound-input").length||(Shiny.initializeInputs(".modal"),Shiny.bindAll(".modal"))})}),$.extend(Shiny.progressHandlers,{"yonder-progress":e=>{if(!e.type||!e.data.outlet)return!1;let t=$(`#${e.data.outlet}`);if("show"===e.type){let n=$(e.data.content);return n[0].id&&t.find(`#${n[0].id}`).length?t.find(`#${n[0].id}`).replaceWith(n):t.append(n),!0}return!1}}),$(()=>{let e=document.querySelectorAll("[data-collapse-id]");e.length&&($(e).wrap(function(){let e={};for(const t of this.attributes)if(t.name.match(/^data[-]collapse/)){e[t.name.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/^data-collapse-/,"")]=t.value}return e.class=`${e.class?e.class+" ":""}collapse`,$("<div>",e)}),$(document.querySelectorAll(".collapse")).collapse()),Shiny.addCustomMessageHandler("yonder:collapse",function(e){if(!e.type||!e.type.match(/^(show|hide|toggle)$/))return;let t=document.getElementById(`${e.data.id}`);t&&t.classList.contains("collapse")&&$(t).collapse(e.type)})}),$(()=>{Shiny.addCustomMessageHandler("yonder:popover",e=>{if(void 0!==e.data.target){if("show"==e.type){let t=e.data,n=`#${t.target}`;return $(n).popover({title:()=>void 0,content:()=>void 0,template:t.content,placement:t.placement,trigger:"manual"}),t.duration&&setTimeout(()=>$(n).popover("hide"),t.duration),void $(n).popover("show")}"close"!=e.type||$(`#${e.data.id}`).popover("hide")}})}),$(()=>{Shiny.addCustomMessageHandler("yonder:modal",function(e){return!!e.type&&("close"===e.type?($(".modal").modal("hide"),!0):"show"===e.type&&($(".modal").length?t=$(".modal"):(t=$("<div class='modal fade' tabindex=-1 role='dialog'></div>"),$(document.body).append(t)),t.html(e.data.content),t.modal(),!0));var t})}),$(()=>{Shiny.addCustomMessageHandler("yonder:download",function(e){if(!(e.filename&&e.token&&e.key))throw"invalid download event";const t="/session/"+e.token+"/download/"+e.key;window.navigator.userAgent;if(ua.indexOf("MSIE ")>0){let n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=(()=>saveAs(n.response,e.filename)),n.send()}else fetch(t).then(e=>e.blob()).then(t=>{saveAs(t,e.filename)})})})}();
//# sourceMappingURL=yonder.min.js.map
